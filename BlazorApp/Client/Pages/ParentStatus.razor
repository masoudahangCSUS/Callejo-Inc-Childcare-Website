@page "/parent_status"
@inject HttpClient Http

<h3>Check Your Registration Status</h3>

<div>
    <label>Enter Your Tracking ID:</label>
    <InputText @bind-Value="trackingId" />
    <button @onclick="CheckStatus">Check Status</button>
</div>

@if (!string.IsNullOrEmpty(statusMessage))
{
    <div class="message">
    <p><strong>Status:</strong> @statusMessage</p>
    </div>
}

@code {
    private string trackingId;
    private string statusMessage;

    private async Task CheckStatus()
    {
        if (string.IsNullOrWhiteSpace(trackingId))
        {
            statusMessage = "Please enter a tracking ID.";
            return;
        }

        var response = await Http.GetAsync($"https://localhost:7139/api/Registration/status/{trackingId}");

        if (response.IsSuccessStatusCode)
        {
            var result = await response.Content.ReadFromJsonAsync<Dictionary<string, string>>();
            statusMessage = $"Status: {result["Status"]}, Submitted on: {result["DateTime"]}";
        }
        else
        {
            statusMessage = "Tracking ID not found.";
        }
    }
}
