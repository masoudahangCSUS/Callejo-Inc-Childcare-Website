@page "/login"

@using BlazorApp.Models
@using Microsoft.AspNetCore.Mvc
@rendermode InteractiveServer
@inject UserSessionService UserSession
@inject NavigationManager Navigation
<PageTitle>LoginPage</PageTitle>
@inject IJSRuntime JS


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <div class="login-page">
    <div class="login-box">
        <h1>CALLEJO INC.</h1>
        <div class="login-form">
            <EditForm Model="account" OnSubmit="HandleLogin" FormName="Login">
                <AntiforgeryToken />
            <div class="input-header">Email Address</div>
            <div class="input-wrapper">
                <i class="fa fa-user"></i>
                <input type="text" placeholder="email" name="userName"/>
            </div>
            <div class="input-header">Password</div>
            <div class="input-wrapper">
                <i class="fa fa-lock"></i>
                <input type="password" placeholder="password" name="passWord" id="passWord"/>
            </div>
                <button class="login-btn" type="submit" formmethod="post">LOGIN</button>
            </EditForm>
            @if (loginState == false)
            {
                <p>Incorrect Username or Password</p>
            }
            <a href="/create-profile" class="create-profile-link">Create Account</a>
            <a href="/forgot-password" class="forgot-password-link">Forgot password?</a>
        </div>
    </div>
</div>

@code
{

    [SupplyParameterFromForm(FormName ="Login")]
    public TestModel? account{ get; set; }

    protected override void OnInitialized() => account ??= new();

    bool loginState = true;
    void HandleLogin()
    {
        if (account!.userName == "admin" && account.passWord == "password")
        {
            UserSession.SetUserLoggedIn(true);
            loginState = true;
            Navigation.NavigateTo("/");
        }
        else
        {
            loginState = false;

        }

    }
}



