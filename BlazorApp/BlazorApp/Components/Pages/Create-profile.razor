@page "/create-profile"
@inject IJSRuntime JS

@inject CallejoSystemDbContext DbContext
@using BlazorApp.Data
@using BlazorApp.Models
@using Microsoft.AspNetCore.Components.Forms

<h3>Create Profile</h3>

<EditForm Model="@newUser" OnSubmit="SaveProfile" FormName="CreateProfileForm">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label>First Name:</label>
        <InputText @bind-Value="newUser.FirstName" class="form-control" />
    </div>

    <div>
        <label>Middle Name:</label>
        <InputText @bind-Value="newUser.MiddleName" class="form-control" />
    </div>

    <div>
        <label>Last Name:</label>
        <InputText @bind-Value="newUser.LastName" class="form-control" />
    </div>

    <div>
        <label>Address:</label>
        <InputText @bind-Value="newUser.Address" class="form-control" />
    </div>

    <div>
        <label>City:</label>
        <InputText @bind-Value="newUser.City" class="form-control" />
    </div>

    <div>
        <label>State:</label>
        <InputText @bind-Value="newUser.State" class="form-control" />
    </div>

    <div>
        <label>Zip Code:</label>
        <InputText @bind-Value="newUser.ZipCode" class="form-control" />
    </div>

    <div>
        <label>Role:</label>
        <InputNumber @bind-Value="newUser.FkRole" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary">Save Profile</button>
</EditForm>


    @code {
        private CallejoIncUser newUser = new CallejoIncUser();

        private async Task SaveProfile()


        {
        Console.WriteLine("Profile saved successfully.");

        var newUser = new CallejoIncUser
            {
                Id = Guid.NewGuid(),
                FirstName = "Jon",
                LastName = "Chris",
                Address = "123 Main St",   // Ensure this is populated
                City = "Example City",
                State = "Example State",
                ZipCode = "12345",
                FkRole = 1 // Assuming 1 is a valid foreign key in Role table
            };
            try
            {

     
                DbContext.CallejoIncUsers.Add(newUser);
                await DbContext.SaveChangesAsync();
                Console.WriteLine("Profile saved successfully.");
                //newUser = new CallejoIncUser(); // Clear the form after save
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error saving profile: {ex.Message}");
            }
        }
    }
}


